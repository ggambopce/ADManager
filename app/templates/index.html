{# templates/index.html #}
{% extends "base/base.html" %}

{% block title %}AD Manager í™ˆ{% endblock %}

{% block content %}
  <section class="hero">
    <div class="hero-main">
      <h1>Ad Server Admin ëŒ€ì‹œë³´ë“œ</h1>
      <p class="hero-subtitle">
        ê´‘ê³  ì´ë¯¸ì§€ë¥¼ ë“±ë¡í•˜ê³ , Buly ìˆë§í¬ì™€ í•¨ê»˜ ê° ë°±ì—”ë“œ ì„œë¹„ìŠ¤ì— ë…¸ì¶œí•  ê´‘ê³ ë¥¼ ê´€ë¦¬í•œë‹¤.
      </p>

      <div class="hero-actions">
        <a href="/ads" class="btn-primary">ê´‘ê³  ëª©ë¡ ë³´ê¸°</a>
        <a href="/ads/new" class="btn-secondary">ìƒˆ ê´‘ê³  ë“±ë¡</a>
      </div>
    </div>

    <div class="hero-side">
      <div class="hero-info-card">
        <h2>ê´€ë¦¬ì ì‘ì—…</h2>

        <div class="admin-task">
          <div class="task-icon">ğŸ“‹</div>
          <div class="task-body">
            <a href="/ads" class="task-title">ì „ì²´ ê´‘ê³  ëª©ë¡ ê´€ë¦¬</a>
            <p class="task-desc">ë“±ë¡ëœ ê´‘ê³ ë¥¼ ì¡°íšŒí•˜ê³ , ìˆ˜ì • Â· ì‚­ì œë¥¼ ìˆ˜í–‰í•œë‹¤.</p>
          </div>
        </div>

        <div class="admin-task">
          <div class="task-icon">ğŸ†•</div>
          <div class="task-body">
            <a href="/ads/new" class="task-title">ìƒˆ ê´‘ê³  ë“±ë¡</a>
            <p class="task-desc">ì´ë¯¸ì§€ ì—…ë¡œë“œ, ì„¤ëª…, ëœë”© URLì„ í¬í•¨í•œ ì‹ ê·œ ê´‘ê³ ë¥¼ ìƒì„±í•œë‹¤.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="dashboard-grid">

    <!-- ì¹´ë“œ 2: ê´‘ê³  ì„œë²„ êµ¬ì¡° ë° API ìš”ì•½ -->
    <article class="card">
      <div class="card-header">
        <h2>ê´‘ê³  ì„œë²„ êµ¬ì¡° ìš”ì•½</h2>
      </div>
      <div class="card-body">

        <h3 class="sub">ì„¸ì…˜ Â· ì¸ì¦</h3>
        <ul class="notes-list">
          <li>ê´€ë¦¬ì ë¡œê·¸ì¸ ì„¸ì…˜ì€ <strong>Redis</strong>ì— ì €ì¥ëœë‹¤.</li>
          <li>ì„¸ì…˜ ID(<code>session_id</code>)ëŠ” <strong>ì¿ í‚¤(admin_session)</strong>ì— ë‹´ì•„ í´ë¼ì´ì–¸íŠ¸ì™€ êµí™˜í•œë‹¤.</li>
          <li>ì‘ë‹µ êµ¬ì¡°ëŠ” <code>code</code>, <code>message</code>, <code>result</code> í˜•íƒœë¥¼ ì‚¬ìš©í•œë‹¤.</li>
        </ul>

        <h3 class="sub" style="margin-top:12px;">API ëª¨ë“ˆ êµ¬ì„± ìš”ì•½</h3>
        <ul class="notes-list">
          <li>ê´€ë¦¬ì(Admin) API: <code>/api/admin/...</code> (ë¡œê·¸ì¸ í•„ìš”)</li>
          <li>ê³µê°œ(Public) ê´‘ê³  API: <code>GET /api/public/ad</code> (ì¸ì¦ ì—†ìŒ, ëœë¤ ê´‘ê³  1ê±´)</li>
          <li>í´ë¼ì´ì–¸íŠ¸ ì•±Â·ì›¹Â·ë°±ì—”ë“œëŠ” ì˜¤ì§ Public APIë§Œ ì‚¬ìš©</li>
          <li>ì´ë¯¸ì§€ íŒŒì¼ì€ ë¡œì»¬ ì €ì¥ í›„ <code>/static/ads/...</code> ë¡œ ì„œë¹™</li>
          <li>ê´‘ê³  ë“±ë¡ ì‹œ <strong>target_urlì„ Buly APIë¡œ í˜¸ì¶œí•˜ì—¬ ë‹¨ì¶• ë„ë©”ì¸(short_url)ìœ¼ë¡œ ë³€í™˜</strong></li>
          <li><strong>short_urlì€ ì‹¤ì œ í´ë¦­ ì´ë²¤íŠ¸ì— ì‚¬ìš©í•˜ëŠ” ë§í¬</strong>ë¡œ í™œìš©ëœë‹¤.</li>
          <li>short_url ë° ì‘ë‹µ êµ¬ì¡°ëŠ” í–¥í›„ <strong>í´ë¦­Â·ì „í™˜ íŠ¸ë˜í‚¹ í™•ì¥</strong>ì„ ê³ ë ¤í•´ ì„¤ê³„í–ˆë‹¤.</li>
        </ul>

        <h3 class="sub" style="margin-top:12px;">API ê°œë°œ ì§„í–‰ ìƒí™©</h3>
        <ul class="notes-list">
          <li>ê´€ë¦¬ì ë¡œê·¸ì¸: <code>POST /api/admin/login</code></li>
          <li>ë¡œê·¸ì•„ì›ƒ: <code>POST /api/auth/logout</code></li>
          <li>ê´€ë¦¬ì ì •ë³´ ì¡°íšŒ: <code>GET /api/admin/me</code></li>
          <li>ê´‘ê³  ë“±ë¡: <code>POST /api/admin/ads</code></li>
          <li>ê´‘ê³  ì „ì²´ ë¦¬ìŠ¤íŠ¸: <code>GET /api/admin/ads</code></li>
          <li>ê´‘ê³  ë‹¨ê±´ ì¡°íšŒ: <code>GET /api/admin/ads/{id}</code></li>
          <li>ê´‘ê³  ìˆ˜ì •: <code>PUT /api/admin/ads/{id}</code></li>
          <li>ê´‘ê³  ì‚­ì œ: <code>DELETE /api/admin/ads/{id}</code></li>
          <li>ê³µê°œìš© ëœë¤ ê´‘ê³  ì¡°íšŒ: <code>GET /api/public/ad</code></li>
        </ul>

        <h3 class="sub" style="margin-top:12px;">ì˜ˆì™¸ ì²˜ë¦¬ ì •ì±…</h3>
        <ul class="notes-list">
          <li>ê¸°ë³¸ ëŸ°íƒ€ì„ ì˜¤ë¥˜ëŠ” ê³µí†µ í•¸ë“¤ëŸ¬ì—ì„œ ì²˜ë¦¬í•œë‹¤.</li>
          <li>í•„ìš”í•œ ê²½ìš° try/catchë¡œ ëª…ì„¸ëœ ì—ëŸ¬ ì½”ë“œë¥¼ ë°˜í™˜í•œë‹¤.</li>
          <li>í´ë¼ì´ì–¸íŠ¸ê°€ ì‹¤íŒ¨ ì›ì¸ì„ ë¹ ë¥´ê²Œ íŒŒì•…í•  ìˆ˜ ìˆë„ë¡ <strong>ëª…í™•í•œ code/message</strong>ë¥¼ ì œê³µí•œë‹¤.</li>
        </ul>

      </div>
    </article>

    <!-- ì¹´ë“œ 3: ê³µê°œ ê´‘ê³  API ì‚¬ìš© ë°©ë²• -->
    <article class="card">
      <div class="card-header">
        <h2>ê³µê°œ ê´‘ê³  API ì‚¬ìš© ë°©ë²•</h2>
      </div>
      <div class="card-body">
        <h3 class="card-subtitle">1. ì—”ë“œí¬ì¸íŠ¸</h3>
        <p class="api-text">
          ì—¬ëŸ¬ ë°±ì—”ë“œ ì„œë²„ì—ì„œ ê³µìš©ìœ¼ë¡œ ì‚¬ìš©í•  <strong>ëœë¤ ê´‘ê³  ì¡°íšŒ API</strong>.
          ì¸ì¦ì´ í•„ìš” ì—†ëŠ” <strong>public ì—”ë“œí¬ì¸íŠ¸</strong>ë‹¤.
        </p>

        <div class="api-block">
          <div class="api-method">GET</div>
          <div class="api-url">/api/public/ad</div>
        </div>

        <h3 class="card-subtitle">2. ì‘ë‹µ ìŠ¤í‚¤ë§ˆ</h3>
        <p class="api-text">ì„±ê³µ ì‹œ JSON êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

        <pre class="code-block"><code>{
  "code": 200,
  "message": "ê´‘ê³  ì¡°íšŒ ì„±ê³µ",
  "result": {
    "id": 1,
    "title": "Traffic_Pro",
    "description": "ì‚¬ì´íŠ¸ í™œì„±í™” í”„ë¡œê·¸ë¨",
    "image_url": "/static/ads/1765247451.656572_Traffic_Pro.png",
    "short_url": "https://buly.kr/BTMhqHX",
    "target_url": "https://marketingmonster.kr/product/..."
  }
}</code></pre>

        <table class="api-table">
          <thead>
            <tr>
              <th>í•„ë“œ</th>
              <th>íƒ€ì…</th>
              <th>ì„¤ëª…</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>code</code></td>
              <td>number</td>
              <td>HTTP ì™€ ë³„ë„ë¡œ ì‚¬ìš©í•˜ëŠ” ë‚´ë¶€ ì‘ë‹µ ì½”ë“œ (200: ì„±ê³µ)</td>
            </tr>
            <tr>
              <td><code>message</code></td>
              <td>string</td>
              <td>ì‘ë‹µ ë©”ì‹œì§€ (ì˜ˆ: "ê´‘ê³  ì¡°íšŒ ì„±ê³µ")</td>
            </tr>
            <tr>
              <td><code>result.id</code></td>
              <td>number</td>
              <td>ê´‘ê³  PK</td>
            </tr>
            <tr>
              <td><code>result.title</code></td>
              <td>string</td>
              <td>ê´‘ê³  ì œëª©</td>
            </tr>
            <tr>
              <td><code>result.description</code></td>
              <td>string</td>
              <td>ê´‘ê³  ì„¤ëª… í…ìŠ¤íŠ¸</td>
            </tr>
            <tr>
              <td><code>result.image_url</code></td>
              <td>string</td>
              <td>ì´ë¯¸ì§€ ì„œë¹™ ì£¼ì†Œ (ì˜ˆ: <code>/static/ads/...</code>)</td>
            </tr>
            <tr>
              <td><code>result.short_url</code></td>
              <td>string</td>
              <td>Buly ë‹¨ì¶• ë„ë©”ì¸ì´ ì ìš©ëœ ìµœì¢… í´ë¦­ URL</td>
            </tr>
            <tr>
              <td><code>result.target_url</code></td>
              <td>string</td>
              <td>ì›ë˜ ëœë”© URL (ìƒí’ˆ / ëœë”© í˜ì´ì§€ ë“±)</td>
            </tr>
          </tbody>
        </table>

        <h3 class="card-subtitle">3. ì˜ˆì‹œ: í´ë¼ì´ì–¸íŠ¸ì—ì„œ í˜¸ì¶œ</h3>
        <p class="api-text">
          ì˜ˆë¥¼ ë“¤ì–´, ë‹¤ë¥¸ ë°±ì—”ë“œ(Spring, FastAPI ë“±)ì—ì„œ ì´ APIë¥¼ í˜¸ì¶œí•´
          ê´‘ê³ ë¥¼ ë…¸ì¶œí•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
        </p>

        <pre class="code-block"><code>// ì˜ˆ: ë¸Œë¼ìš°ì € JSì—ì„œ í˜¸ì¶œ
fetch("https://sandboxie.co.kr/api/public/ad")
  .then(res =&gt; res.json())
  .then(data =&gt; {
    const ad = data.result;
    // ad.image_url ì„ ì´ë¯¸ì§€ srcë¡œ,
    // ad.short_url ì„ a hrefë¡œ ì‚¬ìš©
  });</code></pre>

        <p class="api-text">
          ì„œë²„ ì‚¬ì´ë“œ(Spring, FastAPI ë“±)ì—ì„œëŠ” <code>/api/public/ad</code> ë¥¼
          HTTP í´ë¼ì´ì–¸íŠ¸ë¡œ í˜¸ì¶œí•œ ë’¤, ì‘ë‹µì˜ <code>result</code> ë¥¼ ê·¸ëŒ€ë¡œ
          í”„ë¡ íŠ¸ì— ë„˜ê²¨ì£¼ê±°ë‚˜ ë·° í…œí”Œë¦¿ì— ë°”ì¸ë”©í•˜ë©´ ëœë‹¤.
        </p>
      </div>
    </article>
  </section>

  <style>
    /* í™ˆ í™”ë©´ ì „ìš© ìŠ¤íƒ€ì¼ â€“ ë‚˜ì¤‘ì— style.cssë¡œ ë¹¼ë„ ë¨ */

    .hero {
      display: flex;
      gap: 24px;
      align-items: stretch;
      margin-bottom: 32px;
      flex-wrap: wrap;
    }

    .hero-main {
      flex: 2 1 320px;
    }

    .hero-side {
      flex: 1 1 260px;
    }

    .hero-subtitle {
      margin-top: 8px;
      color: #555;
      line-height: 1.5;
    }

    .hero-actions {
      margin-top: 20px;
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .btn-primary,
    .btn-secondary {
      display: inline-block;
      padding: 10px 18px;
      border-radius: 6px;
      text-decoration: none;
      font-size: 14px;
      font-weight: 600;
    }

    .btn-primary {
      background: #2563eb;
      color: #fff;
    }

    .btn-secondary {
      background: #e5e7eb;
      color: #111827;
    }

    .hero-info-card {
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 16px;
      background: #f9fafb;
      height: 100%;
      box-sizing: border-box;
    }

    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 16px;
    }

    .admin-task {
      display: flex;
      gap: 10px;
      margin-bottom: 12px;
      align-items: flex-start;
    }

    .task-icon {
      font-size: 20px;
      line-height: 1.2;
    }

    .task-body {
      flex: 1;
    }

    .task-title {
      font-weight: 600;
      color: #111827;
      text-decoration: none;
    }

    .task-title:hover {
      text-decoration: underline;
    }

    .task-desc {
      font-size: 13px;
      color: #6b7280;
      margin: 2px 0 0;
    }

    .card {
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      background: #fff;
      padding: 16px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.06);
    }

    .card-header h2 {
      margin: 0 0 8px;
      font-size: 18px;
    }

    .card-body {
      font-size: 14px;
      color: #374151;
    }

    .card-subtitle {
      margin: 12px 0 4px;
      font-size: 14px;
      font-weight: 600;
    }

    .notes-list {
      list-style: disc;
      padding-left: 18px;
      margin: 0;
    }

    .notes-list li {
      margin-bottom: 4px;
      font-size: 13px;
    }

    .api-text {
      font-size: 13px;
      color: #374151;
      margin: 4px 0 8px;
      line-height: 1.5;
    }

    .api-block {
      display: inline-flex;
      align-items: center;
      border-radius: 6px;
      overflow: hidden;
      border: 1px solid #e5e7eb;
      margin: 8px 0 12px;
    }

    .api-method {
      padding: 4px 8px;
      font-size: 12px;
      font-weight: 700;
      background: #dcfce7;
      color: #166534;
    }

    .api-url {
      padding: 4px 10px;
      font-size: 12px;
      background: #f9fafb;
      color: #111827;
    }

    .code-block {
      background: #0f172a;
      color: #e5e7eb;
      padding: 10px 12px;
      border-radius: 6px;
      font-size: 12px;
      overflow-x: auto;
      margin: 8px 0 10px;
    }

    .code-block code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
        "Liberation Mono", "Courier New", monospace;
    }

    .api-table {
      width: 100%;
      border-collapse: collapse;
      margin: 8px 0 12px;
      font-size: 12px;
    }

    .api-table th,
    .api-table td {
      border: 1px solid #e5e7eb;
      padding: 4px 6px;
      text-align: left;
      vertical-align: top;
    }

    .api-table th {
      background: #f9fafb;
      font-weight: 600;
    }

    @media (max-width: 700px) {
      .hero {
        flex-direction: column;
      }
    }
  </style>
{% endblock %}
